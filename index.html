<html>
<head>
	<link rel="stylesheet" type="text/css" href="css/custom.css">
	<script type="text/javascript" src="js/swfobject-2.2.min.js"></script>
	<script type="text/javascript" src="js/dtjava.js"></script>
	<script type="text/javascript" src="js/evercookie.js"></script>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<title>Hercule VS Evercookie</title>
</head>
<body>

<h2>uid = <span id="idtag" style="color: red">currently not set</span></h2>

<div id="hydra-heads">
	<div id="localData" class="hydra-head-loading">
		<label>LocalStorage</label>
	</div>
	<div id="sessionData" class="hydra-head-loading">
		<label>SessionStorage</label>
	</div>
	<div id="windowData" class="hydra-head-loading">
		<label>Window name</label>
	</div>
	<div id="dbData" class="hydra-head-loading">
		<label>Web SQL DB</label>
	</div>
	<div id="idbData" class="hydra-head-loading">
		<label>Indexed DB</label>
	</div>
	<div id="cookieData" class="hydra-head-loading">
		<label>HTTP Cookie</label>
	</div>
	<div id="cacheData" class="hydra-head-loading">
		<label>Web Cache</label>
	</div>
	<div id="etagData" class="hydra-head-loading">
		<label>Etags</label>
	</div>
	<div id="pngData" class="hydra-head-loading">
		<label>PNG reading</label>
	</div>
	<div id="historyData" class="hydra-head-loading">
		<label>CSS History</label>
	</div>
	<div id="javaData" class="hydra-head-loading">
		<label>Java Applet</label>
	</div>
	<div id="lsoData" class="hydra-head-loading">
		<label>Flash Cookie</label>
	</div>
	<div id="hstsData" class="hydra-head-loading">
		<label>HSTS</label>
	</div>
	<div id="slData" class="hydra-head-loading">
		<label>Silverlight</label>
	</div>
	<div id="userData" class="hydra-head-loading">
		<label>User Data</label>
	</div>
	<div id="globalData" class="hydra-head-loading">
		<label>GlobalStorage</label>
	</div>
</div>

<script>
	// Name of my tracking field
	let zombieCookieName = 'uid';

	// Instanciating Zombie Cookie
	let zombieCookie = new evercookie({
		history: true,
		java: true,
		silverlight: true,
		lso: true,
		domain: 'localhost',
		hsts: true,
		hsts_domains: [
			'http://sub1.localhost/php/hsts_cookie.php',
			'http://sub2.localhost/php/hsts_cookie.php',
			'http://sub3.localhost/php/hsts_cookie.php',
			'http://sub4.localhost/php/hsts_cookie.php',
			'http://sub5.localhost/php/hsts_cookie.php',
			'http://sub6.localhost/php/hsts_cookie.php',
			'http://sub7.localhost/php/hsts_cookie.php',
			'http://sub8.localhost/php/hsts_cookie.php'
		],
		publisher: function(item, value) {
			if (document.getElementById(item)) {
				let className = "hydra-head-dead";
				if (value) {
					className = "hydra-head-alive";
				}
				if (document.getElementById(item).className !== className) {
					document.getElementById(item).className = className;
				}
			}
		}
	});

	// Refreshing Zombie Cookie head state
	function refreshZombieCookieState(dont_reset) {
		zombieCookie.get(zombieCookieName, function(best, all) {
			document.getElementById("idtag").innerHTML = best;
		}, dont_reset);
	}

	// Regenerating Zombie Cookie (all heads raising from the death)
	function regenerateZombieCookie() {
		zombieCookie.set(zombieCookieName, document.getElementById('uid').value);
		refreshZombieCookieState(0); // '0' means regeneration of all the dead heads !
	}

	// Refreshing heads every second
	setInterval(refreshZombieCookieState, 1000, 1); // '1' means NO regeneration of the dead heads !

</script>

<label for="uid">User ID</label>
<input type="text" name="uid" id="uid" value="1234"/>
<button onclick="regenerateZombieCookie()">REGENERATE</button>

</body>
</html>
